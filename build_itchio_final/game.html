<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Ycrad - Jeu</title>
    <script src="https://pyodide-cdn2.iodide.io/v0.15.0/full/pyodide.js"></script>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; }
        canvas { display: block; }
        #loading { 
            position: absolute; 
            top: 50%; left: 50%; 
            transform: translate(-50%, -50%); 
            color: white; 
            text-align: center; 
        }
    </style>
</head>
<body>
    <canvas id="canvas" width="800" height="600"></canvas>
    <div id="loading">Chargement du jeu...</div>

    <script>
        async function loadGame() {
            const loading = document.getElementById('loading');
            const canvas = document.getElementById('canvas');
            
            try {
                loading.innerHTML = "Initialisation de Pyodide...";
                
                // Charger Pyodide
                let pyodide = await loadPyodide({
                    indexURL: "https://pyodide-cdn2.iodide.io/v0.15.0/full/"
                });
                
                loading.innerHTML = "Chargement des modules...";
                
                // Installer les dépendances
                await pyodide.loadPackage(["micropip"]);
                const micropip = pyodide.pyimport("micropip");
                await micropip.install("pygame");
                
                loading.innerHTML = "Chargement du jeu...";
                
                // Charger le code Python
                const response = await fetch('main_web.py');
                const code = await response.text();
                
                // Exécuter le jeu
                pyodide.runPython(code);
                
                loading.style.display = "none";
                
            } catch (error) {
                loading.innerHTML = `
                    <div style="color: red;">
                        <h3>Erreur de chargement</h3>
                        <p>${error.message}</p>
                        <button onclick="location.reload()">Réessayer</button>
                    </div>
                `;
            }
        }
        
        loadGame();
    </script>
</body>
</html>
